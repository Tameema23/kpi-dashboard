<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="/static/style.css">
<title>Weekly Reports</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<div class="topbar">
  Weekly KPI Reports
  <button class="logout" onclick="logout()">Logout</button>
</div>

<div class="page">

<div class="back" onclick="location.href='index.html'">← Back to Dashboard</div>

<div class="reports-header">
  <button class="btn export-btn" onclick="exportExcel()">⬇ Export CSV</button>
</div>

<!-- ================= KPI CARDS ================= -->
<div class="kpi-grid-3">
  <div class="kpi-card"><span class="kpi-label">Presentations</span><b id="wk_pres">0</b></div>
  <div class="kpi-card"><span class="kpi-label">Sales</span><b id="wk_sales">0</b></div>
  <div class="kpi-card"><span class="kpi-label">YTD Total ALP</span><b id="wk_ytd_alp">$0</b></div>
  <div class="kpi-card"><span class="kpi-label">Show Ratio</span><b id="wk_show">0%</b></div>
  <div class="kpi-card"><span class="kpi-label">Closing %</span><b id="wk_close">0%</b></div>
  <div class="kpi-card"><span class="kpi-label">ALP / Sale</span><b id="wk_alp">$0</b></div>
  <div class="kpi-card"><span class="kpi-label">Conversion Ratio</span><b id="wk_conv">0%</b></div>
  <div class="kpi-card"><span class="kpi-label">Bad Lead Ratio</span><b id="wk_bad_lead">0%</b></div>
  <div class="kpi-card"><span class="kpi-label">Refs / Pres</span><b id="wk_refs">0</b></div>
</div>

<!-- ================= WEEKLY PERFORMANCE ================= -->
<h2 class="section-title">Weekly Performance</h2>

<section class="chart-grid-2">
  <div class="card chart-card">
    <canvas id="salesChart"></canvas>
  </div>
  <div class="card chart-card">
    <canvas id="presentationsChart"></canvas>
  </div>
</section>

<section class="chart-grid-1">
  <div class="card chart-card">
    <div style="position:relative; height:300px;">
      <canvas id="showRatioChart"></canvas>
    </div>
  </div>
</section>

<!-- ================= YTD RATIOS ================= -->
<h2 class="section-title">Year-to-Date Ratios</h2>

<section class="chart-grid-2">
  <div class="card chart-card">
    <div style="position:relative; height:300px;">
      <canvas id="closingPieChart"></canvas>
    </div>
  </div>
  <div class="card chart-card">
    <div style="position:relative; height:300px;">
      <canvas id="showRatioPieChart"></canvas>
    </div>
  </div>
</section>

<!-- ================= YEAR TO DATE TRENDS ================= -->
<h2 class="section-title">Year-to-Date Trends</h2>

<section class="chart-grid-2">
  <div class="card chart-card">
    <canvas id="salesClosingYTD"></canvas>
  </div>
  <div class="card chart-card">
    <canvas id="alpYTDChart"></canvas>
  </div>
</section>

<!-- ================= LEAD RATIOS ================= -->
<h2 class="section-title">Lead Ratios</h2>

<section class="chart-grid-1">
  <div class="card chart-card">
    <div class="lead-ratio-controls">
      <button class="btn small lead-ratio-toggle active" data-period="ytd">YTD</button>
      <button class="btn small lead-ratio-toggle" data-period="q1">Q1</button>
      <button class="btn small lead-ratio-toggle" data-period="q2">Q2</button>
      <button class="btn small lead-ratio-toggle" data-period="q3">Q3</button>
      <button class="btn small lead-ratio-toggle" data-period="q4">Q4</button>
    </div>
    <div style="position:relative; height:320px;">
      <canvas id="leadRatioChart"></canvas>
    </div>
  </div>
</section>

</div>

<script src="/static/app.js"></script>
<script>loadWeekly();</script>
</body>
</html>