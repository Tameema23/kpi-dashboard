<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="/static/style.css">
<title>Weekly Reports</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<div class="topbar">Weekly KPI Reports</div>

<div class="page">

<div class="back" onclick="location.href='index.html'">‚Üê Back to Dashboard</div>

<div class="controls">


  <button class="btn export-btn" onclick="exportExcel()">Export Excel</button>

</div>


<div class="kpi-grid">
<div class="kpi-card">Presentations<b id="wk_pres">0</b></div>
<div class="kpi-card">Sales<b id="wk_sales">0</b></div>
<div class="kpi-card">Show Ratio<b id="wk_show">0%</b></div>
<div class="kpi-card">Closing %<b id="wk_close">0%</b></div>
<div class="kpi-card">ALP / Sale<b id="wk_alp">$0</b></div>
<div class="kpi-card">Refs / Pres<b id="wk_refs">0</b></div>
<div class="kpi-card">
  YTD Total ALP
  <b id="wk_ytd_alp">$0</b>
</div>
<div class="kpi-card">Conversion Ratio<b id="wk_conv">0%</b></div>
<div class="kpi-card">Bad Lead Ratio<b id="wk_bad_lead">0%</b></div>
</div>

   <!-- ================= WEEKLY ================= -->
    <h2 class="section-title">Weekly Performance</h2>

    <section class="chart-grid">
      <div class="card chart-card">
        <canvas id="salesChart"></canvas>
      </div>

      <div class="card chart-card">
        <canvas id="presentationsChart"></canvas>
      </div>

      <div class="card chart-card">
        <canvas id="showRatioChart"></canvas>
      </div>

      <div class="card chart-card">
        <canvas id="closingPieChart"></canvas>
      </div>

      <div class="card chart-card">
        <canvas id="showRatioPieChart"></canvas>
      </div>
    </section>

    <!-- ================= YEAR TO DATE ================= -->
    <h2 class="section-title">Year-to-Date</h2>

    <section class="chart-grid">
      <div class="card chart-card">
        <canvas id="salesClosingYTD"></canvas>
      </div>

      <div class="card chart-card">
        <canvas id="alpYTDChart"></canvas>
      </div>
    </section>

    <!-- ================= LEAD RATIOS ================= -->
    <h2 class="section-title">Lead Ratios</h2>

    <section class="chart-grid" style="grid-template-columns: 1fr;">
      <div class="card chart-card">
        <div class="lead-ratio-controls">
          <button class="btn small lead-ratio-toggle active" data-period="ytd">YTD</button>
          <button class="btn small lead-ratio-toggle" data-period="q1">Q1</button>
          <button class="btn small lead-ratio-toggle" data-period="q2">Q2</button>
          <button class="btn small lead-ratio-toggle" data-period="q3">Q3</button>
          <button class="btn small lead-ratio-toggle" data-period="q4">Q4</button>
        </div>
        <canvas id="leadRatioChart"></canvas>
      </div>
    </section>


</div>

<script src="/static/app.js"></script>
<script>
  loadWeekly();
</script>
</body>
</html>